<!-- source/docker-top/DockerStats.page -->
Menu="Dashboard:page"
Icon="docker-top.png"
Title="Docker Top"
---
<?php
$plugin = "docker-top";
?>

<link rel="stylesheet" href="/plugins/<?php echo $plugin; ?>/styles.css">
<script src="/plugins/<?php echo $plugin; ?>/stats.js"></script>

<table id="db-docker-top" class="dashboard">
    <thead>
        <tr>
            <td>
                <span class="tile-header">
                    <span class="tile-header-left">
                        <i class="fa fa-th-large f32"></i>
                        <div class="section">
                            <h3 class="tile-header-main">DOCKER TOP</h3>
                            <span id="docker-top-subtitle">Top 10 by CPU</span>
                        </div>
                    </span>
                    <span class="tile-header-right">
                        <span class="tile-header-right-controls">
                            <!-- Custom Controls -->
                            <span style="margin-right: 12px; display: inline-flex; align-items: center; gap: 8px;">
                                <select id="docker-top-metric-select" onchange="updateDockerTop()" style="height: 22px; padding: 0 4px; font-size: 1.1rem; border: 1px solid #ddd; border-radius: 3px;">
                                    <option value="cpu">CPU</option>
                                    <option value="mem">Mem</option>
                                    <option value="disk">I/O</option>
                                </select>
                                <i class="fa fa-refresh control" onclick="updateDockerTop()" title="Refresh" style="cursor: pointer; font-size: 14px;"></i>
                            </span>
                            
                            <!-- Standard Unraid Icons -->
                            <a href="/Settings/DockerTopSettings" title="Settings"><i class="fa fa-fw fa-cog control"></i></a>
                            <a href="#" class="toggle-vis" data-target=".dash_docker_top_body" title="Collapse/Expand"><i class="fa fa-fw fa-chevron-up control"></i></a>
                        </span>
                    </span>
                </span>
            </td>
        </tr>
    </thead>
    <tbody class="dash_docker_top_body sortable">
        <tr>
            <td>
                <div id="docker-top-list" class="docker-top-list">
                    <!-- Content populated by JS -->
                    <div class="docker-top-loading">Loading stats...</div>
                </div>
                
                <div id="docker-top-details" class="docker-top-details-toggle" onclick="toggleDetails()" style="text-align: center; padding: 8px; cursor: pointer; font-size: 1.1rem; opacity: 0.6;">
                    Hide details
                </div>
            </td>
        </tr>
    </tbody>
</table>

<script>
// Toggle details visibility
function toggleDetails() {
    const list = document.getElementById('docker-top-list');
    const toggle = document.getElementById('docker-top-details');
    if (list.style.display === 'none') {
        list.style.display = 'block';
        toggle.innerText = 'Hide details';
    } else {
        list.style.display = 'none';
        toggle.innerText = 'Show details';
    }
}

// Init
$(document).ready(function() {
    // Start polling
    setInterval(updateDockerTop, 3000); // 3 seconds refresh
    updateDockerTop();
});
</script>
